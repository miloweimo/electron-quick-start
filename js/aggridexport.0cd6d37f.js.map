{"version":3,"sources":["webpack:///./src/modules/aggridexport/index.vue","webpack:///src/modules/aggridexport/index.vue","webpack:///./src/modules/aggridexport/index.vue?5aa7","webpack:///./src/modules/aggridexport/index.vue?2dc1","webpack:///./src/modules/aggridexport/index.vue?646e"],"names":["_c","_self","staticClass","on","staticStyle","attrs","_vm","staticRenderFns","render","LicenseManager","setLicenseKey","components","AgGridVue","data","columnDefs","field","valueFormatter","params","value","cellClass","cellRenderer","excelStyles","id","dataType","rowData","name","desc","number","text","action","gridOptions","defaultColDef","sortable","filter","resizable","methods","onFirstDataRendered","gridApi","api","gridColumnApi","columnApi","exportToExcel","exportDataAsExcel","exportToCsv","exportDataAsCsv","component"],"mappings":"8JAA4CA,EAAOC,WAAS,MAAU,KAAOC,UAAY,GAAM,OAAM,QAAQ,CAACA,YAAY,QAAOC,CAAE,EAAC,Q,YAAS,O,GAAiB,CAA0B,kBAAC,4BAAiEA,CAAE,EAAC,oC,YAAS,O,GAAiB,CAAwB,kBAAC,0BAAgFC,2BAAY,iB,YAAU,kBAAM,YAAC,CAACC,OAAM,Q,MAA8B,CAAuB,cAAc,EAAI,WAAa,aAAeC,QAAgB,6BAAG,eAAC,eAA8C,IAAIA,sBAAoBN,EAAG,uBAEhmBO,UAAe,GAAI,SAAW,qTAAcP,EAAe,YAAC,MAAU,KACxE,UAAW,GAAC,OAAO,EAAC,IAAI,6D,WAAiB,MAAU,KACnD,UAAW,GAAC,OAAO,EAAC,IAAI,oI,WAAiB,MAAU,KACnD,UAAW,GAAC,OAAO,EAAC,IAAI,4M,WAAiB,MAAU,KAAsCK,EAAK,EAAC,S,OAAC,EAAM,IAAC,8BAAoE,OAAIC,KAAO,uE,CAAgG,KAAM,wEAAC,eAAkF,OAAIA,KAAO,qFAG5X,GAASE,4B,wBCyCTC,OAAAC,cAAA,mTAEe,OACfC,WAAA,CACAC,0BAEAC,OACA,OACAC,WAAA,CACA,CAAAC,MAAA,QACA,CACAA,MAAA,OACAC,eAAAC,GACA,OAAAA,QAAA,IAAAA,KAAAC,MAGAD,EAAAC,MAFA,SAKA,CACAH,MAAA,SACAI,UAAA,cAMA,CACAJ,MAAA,OACAI,UAAA,cAEA,CACAJ,MAAA,SACAK,aAAAH,GACA,yDAAAA,EAAAC,mBAIAG,YAAA,CACA,CACAC,GAAA,aACAC,SAAA,WAGAC,QAAA,CACA,CAAAC,KAAA,OAAAC,KAAA,GAAAC,OAAA,KAAAC,KAAA,6BAAAC,OAAA,QACA,CAAAJ,KAAA,SAAAC,KAAA,GAAAC,OAAA,gBAAAC,KAAA,IACA,CAAAH,KAAA,SAAAC,KAAA,GAAAC,OAAA,KAAAC,KAAA,iCACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,gBAAAC,KAAA,oBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,QAAA,iBAAAC,KAAA,qBACA,CAAAH,KAAA,OAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,oBACA,CAAAH,KAAA,SAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,oBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,iBAAAC,KAAA,qBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,kBAAAC,KAAA,sBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,mBAAAC,KAAA,wBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,mBAAAC,KAAA,wBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,oBAAAC,KAAA,yBACA,CAAAH,KAAA,QAAAC,KAAA,MAAAC,OAAA,qBAAAC,KAAA,mCAEAE,YAAA,CACAC,cAAA,CACAC,UAAA,EACAC,QAAA,EACAC,WAAA,MAKAC,QAAA,CACAC,oBAAAnB,GACA,KAAAoB,QAAApB,EAAAqB,IACA,KAAAC,cAAAtB,EAAAuB,WAEAC,gBACA,KAAAJ,QAAAK,qBAEAC,cACA,KAAAN,QAAAO,qBC9H2X,I,wBCQvXC,EAAY,eACd,EACA,EACAtC,GACA,EACA,KACA,WACA,MAIa,aAAAsC,E,2CCnBf","file":"js/aggridexport.0cd6d37f.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"pa-4\"},[_c('v-btn',{staticClass:\"ma-2\",on:{\"click\":function($event){return _vm.exportToExcel()}}},[_vm._v(\" Export to Excel \")]),_c('v-btn',{staticClass:\"ma-2\",on:{\"click\":function($event){return _vm.exportToCsv()}}},[_vm._v(\" Export to Csv \")]),_c('ag-grid-vue',{staticClass:\"ag-theme-alpine\",staticStyle:{\"height\":\"65vh\"},attrs:{\"column-defs\":_vm.columnDefs,\"row-data\":_vm.rowData,\"grid-options\":_vm.gridOptions,\"excel-styles\":_vm.excelStyles},on:{\"first-data-rendered\":_vm.onFirstDataRendered}}),_vm._m(0),_vm._m(1),_c('p',[_vm._v(\"浮点数位数字多于15位，已经超出了 JavaScript 精确浮点数范围 -1.7976931348623157e+308 至 1.7976931348623157e+308 （即正负2的1024次方）\")]),_c('p',[_vm._v(\"整数位数字多于16位，已经超出了 JavaScript 精确整数范围 -9007199254740992 至 9007199254740992 （即正负2的53次方）\")]),_c('p',[_vm._v(\"或者已经因为过长的数字而显示为科学计数的，要让数据来源为字符串，否则无法保证数字精度和导出的excel为正常数字\")]),_vm._m(2),_vm._m(3)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('p',[_c('b',[_vm._v(\"注意：\")]),_vm._v(\"长数字导出excel，在excel显示为科学计数的问题\")])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',[_vm._v(\"对于长数字 excel、csv数字转为字符串，即要表头定义\"),_c('code',[_vm._v(\"cellClass\")]),_vm._v(\"为\"),_c('code',[_vm._v(\"stringType\")]),_vm._v(\"然后再导出，就没问题\")])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',[_vm._v(\" JavaScript 提供Number对象的MAX_VALUE和MIN_VALUE属性，返回可以表示的具体的最大值和最小值。 \"),_c('br'),_c('code',[_vm._v(\"Number.MAX_VALUE // 1.7976931348623157e+308\")]),_c('br'),_c('code',[_vm._v(\"Number.MIN_VALUE // 5e-324\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',[_vm._v(\" 参考文档\"),_c('br'),_c('a',{attrs:{\"href\":\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\"}},[_vm._v(\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\")]),_c('br'),_c('a',{attrs:{\"href\":\"https://wangdoc.com/javascript/types/number#%E6%95%B0%E5%80%BC%E7%B2%BE%E5%BA%A6\"}},[_vm._v(\"JavaScript 数值精度\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"pa-4\">\n    <v-btn\n      class=\"ma-2\"\n      @click=\"exportToExcel()\"\n    >\n      Export to Excel\n    </v-btn>\n    <v-btn\n      class=\"ma-2\"\n      @click=\"exportToCsv()\"\n    >\n      Export to Csv\n    </v-btn>\n    <ag-grid-vue\n      style=\"height: 65vh;\"\n      class=\"ag-theme-alpine\"\n      :column-defs=\"columnDefs\"\n      :row-data=\"rowData\"\n      :grid-options=\"gridOptions\"\n      :excel-styles=\"excelStyles\"\n      @first-data-rendered=\"onFirstDataRendered\"\n    />\n    <p><b>注意：</b>长数字导出excel，在excel显示为科学计数的问题</p>\n    <p>对于长数字 excel、csv数字转为字符串，即要表头定义<code>cellClass</code>为<code>stringType</code>然后再导出，就没问题</p>\n    <p>浮点数位数字多于15位，已经超出了 JavaScript 精确浮点数范围 -1.7976931348623157e+308 至 1.7976931348623157e+308 （即正负2的1024次方）</p>\n    <p>整数位数字多于16位，已经超出了 JavaScript 精确整数范围 -9007199254740992 至 9007199254740992 （即正负2的53次方）</p>\n    <p>或者已经因为过长的数字而显示为科学计数的，要让数据来源为字符串，否则无法保证数字精度和导出的excel为正常数字</p>\n    <p>\n      JavaScript 提供Number对象的MAX_VALUE和MIN_VALUE属性，返回可以表示的具体的最大值和最小值。\n      <br>\n      <code>Number.MAX_VALUE // 1.7976931348623157e+308</code>\n      <br>\n      <code>Number.MIN_VALUE // 5e-324</code>\n    </p>\n    <p>\n      参考文档<br>\n      <a href=\"https://www.ag-grid.com/angular-data-grid/excel-export-data-types/\">https://www.ag-grid.com/angular-data-grid/excel-export-data-types/</a>\n      <br>\n      <a href=\"https://wangdoc.com/javascript/types/number#%E6%95%B0%E5%80%BC%E7%B2%BE%E5%BA%A6\">JavaScript 数值精度</a>\n    </p>\n  </div>\n</template>\n\n<script>\nimport { LicenseManager } from 'ag-grid-enterprise';\nimport { AgGridVue } from 'ag-grid-vue';\n\n// 挖槽 不去注册的话，exportDataAsExcel不能用\nLicenseManager.setLicenseKey('CompanyName=Suzhou ruhlamat Smart Technologies Co., Ltd.,LicensedApplication=Infinity,LicenseType=SingleApplication,LicensedConcurrentDeveloperCount=1,LicensedProductionInstancesCount=30,AssetReference=AG-030422,SupportServicesEnd=30_August_2023_[v2]_MTY5MzM1MDAwMDAwMA==28423dd515d527503fc5a257dc86a8ac');\n\nexport default {\n  components: {\n    AgGridVue,\n  },\n  data() {\n    return {\n      columnDefs: [\n        { field: 'name' },\n        {\n          field: 'desc',\n          valueFormatter: (params) => { // 只是修改显示的文字，不改变表格数据，导出也不影响\n            if (!params?.value) {\n              return '<无描述>';\n            }\n            return params.value;\n          },\n        },\n        {\n          field: 'number',\n          cellClass: 'stringType', // 配合excelStyles，这样导出的excel就不是科学计数了\n          // valueGetter: arg => { // 改变表格显示的文字\n          //   const num = arg.data.number;\n          //   return num.toString() + '\\t' + '@@@'\n          // },\n        },\n        {\n          field: 'text',\n          cellClass: 'stringType', // 配合excelStyles，这样导出的excel就不是科学计数了\n        },\n        {\n          field: 'action',\n          cellRenderer: (params) => {\n            return `<button style=\"border: 1px solid;border-radius: 5px;\">${params.value}</button>`;\n          },\n        },\n      ],\n      excelStyles: [\n        {\n          id: 'stringType',\n          dataType: 'String',\n        },\n      ],\n      rowData: [\n        { name: '一般整数', desc: '', number: 72000, text: '带中文数字123456789012334243433', action: 'test' },\n        { name: '测试带小数位', desc: '', number: 35000.231231231, text: '' },\n        { name: '带.00小数', desc: '', number: 32000.00, text: 'engnumber12345678901234567890' },\n        { name: '测试长整数', desc: '16位', number: 1234567890123456, text: '1234567890123456' },\n        { name: '极限-整数', desc: '16位', number: -9007199254740992, text: '-9007199254740992' },\n        { name: '极限整数', desc: '16位', number: 9007199254740992, text: '9007199254740992' },\n        { name: '极限整数+1', desc: '16位', number: 9007199254740993, text: '9007199254740993' },\n        { name: '测试长整数', desc: '17位', number: 12345678901234567, text: '12345678901234567' },\n        { name: '测试长整数', desc: '18位', number: 123456789012345678, text: '123456789012345678' },\n        { name: '测试长整数', desc: '19位', number: 1234567890123456789, text: '12345678901234567890' },\n        { name: '测试长整数', desc: '20位', number: 12345678901234567890, text: '12345678901234567890' },\n        { name: '测试长整数', desc: '21位', number: 123456789012345678901, text: '123456789012345678901' },\n        { name: '测试长整数', desc: '30位', number: 123456789012345678901234567890, text: '123456789012345678901234567890' },\n      ],\n      gridOptions: {\n        defaultColDef: {\n          sortable: true,\n          filter: true,\n          resizable: true,\n        },\n      },\n    };\n  },\n  methods: {\n    onFirstDataRendered(params) {\n      this.gridApi = params.api;\n      this.gridColumnApi = params.columnApi;\n    },\n    exportToExcel() {\n      this.gridApi.exportDataAsExcel();\n    },\n    exportToCsv() {\n      this.gridApi.exportDataAsCsv();\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import \"~ag-grid-community/styles/ag-grid.css\";\n@import \"~ag-grid-community/styles/ag-theme-alpine.css\";\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=34dc547d&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=34dc547d&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"34dc547d\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=34dc547d&prod&scoped=true&lang=scss\""],"sourceRoot":""}