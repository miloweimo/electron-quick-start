(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vform"],{c34e:function(t,e,a){"use strict";a.r(e);var s=a("7265"),i=a("8b60"),r=a("e37c"),n=a("2370"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-4"},[e("h1",[t._v("测试在v-form下面的v-datatable重置问题")]),e("div",{staticClass:"rounded pa-4",staticStyle:{border:"1px solid","min-height":"300px"}},[e("h2",[t._v("问题复现: 我复现了这个bug：在v-form中使用v-data-table，重置表单后，push数据到data table无变化；")]),e(s["a"],{on:{click:function(e){return t.$refs.form.reset()}}},[t._v(" 重置 ")]),e(r["a"],{ref:"form",attrs:{"lazy-validation":""}},[e("div",[e(n["a"],{model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),e(s["a"],{on:{click:t.hanlePush}},[t._v(" Push to Table ")])],1),t._v(" "+t._s(t.dataList)+" "),e(i["a"],{attrs:{items:t.dataList,headers:t.headers}})],1)],1),e("hr"),t._v(" 是因为，v-form 会重置表单中的所有input输入框，对应的就是v-data-table的每页数量 "),e("hr"),e("fixed")],1)},d=[],o=(a("0894"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-4"},[e("div",{staticClass:"rounded pa-4 mt-4",staticStyle:{border:"1px solid","min-height":"300px"}},[t._m(0),e(s["a"],{on:{click:t.handleReset}},[t._v(" 重置 ")]),e(r["a"],{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("div",[e(n["a"],{model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),e(s["a"],{on:{click:t.hanlePush}},[t._v(" Push to Table ")])],1),t._v(" dataList:"+t._s(t.dataList)+" "),e("hr"),t._v(" selectedList:"+t._s(t.selectedList)+" "),e(i["a"],{ref:"table",attrs:{"show-select":"",height:"300px",items:t.list,headers:t.headers,"item-key":"age","items-per-page":t.num},on:{"update:itemsPerPage":function(e){t.num=e},"update:items-per-page":function(e){t.num=e}},model:{value:t.selectedList,callback:function(e){t.selectedList=e},expression:"selectedList"}})],1)],1)])}),h=[function(){var t=this,e=t._self._c;return e("h2",[t._v(" 解决方案: "),e("br"),t._v(" v-form下的v-data-table，:items-per-pag加上.sync； 在重置v-form时，$nextTick重新赋值v-data-table的items-per-page ")])}],u={data(){return{valid:!0,num:5,text:"123",dataList:[{name:"张三",age:18},{name:"李四",age:19}],headers:[{text:"姓名",value:"name"},{text:"年龄",value:"age"}],selectedList:[]}},computed:{list(){return[...this.dataList]}},methods:{hanlePush(){this.dataList.push({name:this.text,age:20+this.dataList.length})},handleReset(){this.$refs.form.reset(),console.log(this.num,"num @@1"),this.$nextTick(()=>{this.num=10})}}},c=u,m=a("2be6"),v=Object(m["a"])(c,o,h,!1,null,null,null),p=v.exports,f={components:{fixed:p},data(){return{text:"123",dataList:[{name:"张三",age:18},{name:"李四",age:19}],headers:[{text:"姓名",value:"name"},{text:"年龄",value:"age"}]}},methods:{hanlePush(){this.dataList.push({name:this.text,age:20+this.dataList.length})}}},_=f,g=Object(m["a"])(_,l,d,!1,null,null,null);e["default"]=g.exports},e37c:function(t,e,a){"use strict";a("0894");var s=a("5d20"),i=a("27d6"),r=a("d6c5"),n=a("e479");e["a"]=Object(s["a"])(i["a"],Object(r["b"])("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>t.$watch("hasError",e=>{this.$set(this.errorBag,t._uid,e)},{immediate:!0}),a={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=t.$watch("shouldValidate",s=>{s&&(this.errorBag.hasOwnProperty(t._uid)||(a.valid=e(t)))}):a.valid=e(t),a},validate(){return 0===this.inputs.filter(t=>!t.validate(!0)).length},reset(){this.inputs.forEach(t=>t.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(t=>t.resetValidation()),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find(e=>e._uid===t._uid);if(!e)return;const a=this.watchers.find(t=>t._uid===e._uid);a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter(t=>t._uid!==e._uid),this.inputs=this.inputs.filter(t=>t._uid!==e._uid),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:t=>this.$emit("submit",t)}},Object(n["s"])(this))}})}}]);
//# sourceMappingURL=vform.844a4bba.js.map